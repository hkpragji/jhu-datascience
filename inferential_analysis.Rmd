---
title: "Part II: Inferential Analysis"
subtitle: "for the Statistical Inference Course Project"
author: "Hiten Pragji"
date: "`r format(Sys.Date(), '%d-%m-%Y')`"
output: 
  pdf_document:
    toc: false
    number_sections: true
    latex_engine: xelatex
geometry: margin=0.45in
fontsize: 10pt
header-includes:
  - \usepackage{amsmath}
  - \usepackage{amssymb}
  - \usepackage{graphicx}
  - \usepackage[numbers]{natbib}
  - \usepackage{url}
  - \usepackage{caption}
  - \usepackage{notoccite}
  - \usepackage{enumitem}
  - \usepackage{caption}
  - \usepackage{xcolor}
  - \usepackage{titlesec}
  - \usepackage{parskip}
  - \usepackage{hyperref}
  - \usepackage{mathtools}
  - \usepackage{bm}
  - \usepackage{dsfont}
  - \usepackage{bigints}
  - \usepackage[nointlimits]{esint}
  - \usepackage{titlesec}
  - \titleformat*{\section}{\large\bfseries}
  - \titleformat*{\subsection}{\normalsize\bfseries}
---

```{r setup, echo = FALSE, message = FALSE, warning = FALSE}
# Load required libraries
library(dplyr)
library(ggplot2)
library(moments)
library(datasets)
data(ToothGrowth)
attach(ToothGrowth)
# Set chunk options
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

\section{Introduction}

A concern during the Second World War was the provision of vitamin C to soldiers, and in this broad context the effects of ascorbic acid and orange juice were studied in animals. In one such study, 68 guinea pigs, all 28 days old, were given a dietary supplement of vitamin C in one of three doses (0.5, 1, or 2 mg/day) delivered in one of two ways (as ascorbic acid or in orange juice). There were 10 guinea pigs, 5 males and 5 females, in each combination of dose and delivery. After 42 days on the diet, the guinea pigs were sacrificed; incisors were removed and sectioned to obtain measurements on the length of the odontoblasts - cells that are important to tooth development. There could be multiple measurements (odontoblasts) per animal, so the lengths were averaged to give a single value for each animal. The outcome of interest is the average length of the incisor odontoblasts; this was measured in microns. The interest is in how dose and method of delivery influence the outcome.\cite{crampton1947growth}

\section{Aims}

The aim of this analysis is to compare tooth growth by supplement type and dose. To do this, we will import the `ToothGrowth` dataset; the dependent variable (response) is the length of odontoblasts and the independent variables (predictors) are supplement type and dose.

\section{Data description}

```{r explore-data}
# Preview dataset structure
glimpse(ToothGrowth)
str(ToothGrowth)
# Show summary statistics
summary(ToothGrowth)
# View breakdown of dose
ToothGrowth %>%
  dplyr::group_by(dose) %>%
  dplyr::summarise(n = n())
# View breakdown of supplement type
ToothGrowth %>%
  dplyr::group_by(supp) %>%
  dplyr::summarise(n = n())
```

\section{Exploratory data analysis}

\subsection{Overall distribution of odontoblast length}

```{r eda-plot1}
# Plot basic histogram
ggplot2::ggplot(
  ToothGrowth,
  aes(x = len)
) +
  ggplot2::geom_histogram(
    bins = 20,
    col = "black",
    fill = "lightblue"
  )

moments::skewness(ToothGrowth$len)
moments::kurtosis(ToothGrowth$len)
```

The overall distribution of odontoblast length is near-normal with very slight skewness of -0.15 and the distribution is platykurtic with a kurtosis of 2.02. Although the distribution is not perfectly Gaussian, the observed skewness and kurtosis indicate only minor deviations from normality, and therefore the use of parametric methods such as t-tests remains appropriate.

\subsection{Relationship between dose and odontoblast length}

```{r eda-plot2}
# Plot length x dose
ggplot2::ggplot(
  ToothGrowth,
  aes(x = dose, y = len)
) +
  ggplot2::geom_point()
```

The scatter plot suggests that higher doses of vitamin C, irrespective of supplement type, are associated with increased mean odontoblast length.

\subsection{Effect of supplement type on odontoblast length}

```{r eda-plot3}
ggplot2::ggplot(
  ToothGrowth,
  aes(x = supp, y = len, colour = supp)
) +
  ggplot2::geom_boxplot() +
  ggplot2::facet_grid(~ dose)
```

The boxplots suggest that, for doses of 0.5 mg/day and 1.0 mg/day, supplementation with orange juice was associated with increased mean odontoblast length, however for doses of 2.0 mg/day, the difference in length was not as significant. The natural next step in this analysis is to test, using inference, whether:

\begin{enumerate}
  \item Mean odontoblast length differs by supplement type;
  \item Mean odontoblast length differs by dose;
  \item Dose effect depends on supplement type.
\end{enumerate}

\section{Methods}

\subsection{Hypotheses}

1. Effect of supplement type on mean odontoblast length: $H_{0}: \mu_{\text{OJ}} = \mu_{\text{VC}}$, $H_{1}: \mu_{\text{OJ}} \neq \mu_{\text{VC}}$.

2. Effect of dose on mean odontoblast length: $H_{0}: \mu_{1} = \mu_{2} = \mu_{3}$, $H_{1}: \exists i,j \in {1,2,3}, i \neq j \text{ such that } \mu_{i} \neq \mu_{j}$.

3. Effect of supplement type on dose response: 

\subsection{Statistical methods}

All hypothesis tests were conducted at a 5$\%$ significance level ($\alpha = 0.5$).

\subsection{Assumptions}

In this analysis, it is assumed that:

\begin{enumerate}
  \item Mean odontoblast length is approximately normally distributed within each group;
  \item Each length observation is independent;
  \item The variability in mean odontoblast length is different across dose and supplement groups.
\end{enumerate}

\section{Results}

\subsection{Effect of supplement type on odontoblast length}

```{r length-supp-test}
# Create separate dataframes for OJ and VC
oj_len <- ToothGrowth %>%
  dplyr::filter(supp == "OJ") %>%
  dplyr::pull(len)
vc_len <- ToothGrowth %>%
  dplyr::filter(supp == "VC") %>%
  dplyr::pull(len)
# Run two-tailed T-test
t_test_supp <- t.test(oj_len, vc_len, alternative = "two.sided", paired = FALSE, var.equal = FALSE, conf.level = 0.95)
print(t_test_supp$p.value)
```

Since $p = 0.06 > \alpha$, we fail to reject the null hypothesis; there is insufficient evidence to conclude that the supplement type has a significant impact on the mean length of odontoblasts.

\subsection{Effect of dose on odontoblast length}

```{r prep-length-dose-test}
d05 <- ToothGrowth %>%
  dplyr::filter(dose == 0.5) %>%
  dplyr::pull(len)
d10 <- ToothGrowth %>%
  dplyr::filter(dose == 1.0) %>%
  dplyr::pull(len)
d20 <- ToothGrowth %>%
  dplyr::filter(dose == 2.0) %>%
  dplyr::pull(len)
```

The following t-tests are used to investigate whether there is a significant difference in mean odontoblast lengths between different doses:

\textbf{\underline{$D_{0.5}$ vs $D_{1.0}$}}

```{r length-dose-test1}

```

\textbf{\underline{$D_{0.5}$ vs $D_{2.0}$}}

```{r length-dose-test2}

```

\textbf{\underline{$D_{1.0}$ vs $D_{2.0}$}}

```{r length-dose-test3}

```

\subsection{Effect of supplement type on dose response}

\section{Discussion}

\section{Conclusion}

\clearpage

\bibliographystyle{IEEEtranN}
\bibliography{inferential}

